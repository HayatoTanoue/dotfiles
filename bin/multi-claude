#!/bin/bash
# multi-claude - launch multiple Claude Code panes with orchestrator
# Usage: multi-claude [2|3|4]
#
# Layout:
# ┌──────────┬──────────┐
# │ Claude 1 │ Claude 2 │  ~55%
# ├──────────┼──────────┤
# │ terminal │ terminal │  ~25%
# ├──────────┴──────────┤
# │    orchestrator     │  ~20%
# └─────────────────────┘

COLS="${1:-2}"
SESSION="multi-claude"

if tmux has-session -t ${SESSION} 2>/dev/null; then
  tmux attach -t ${SESSION}
  exit 0
fi

tmux new-session -d -s ${SESSION}

# Create columns (columns - 1 horizontal splits)
for i in $(seq 2 ${COLS}); do
  tmux split-window -h -t ${SESSION}:1
  tmux select-layout -t ${SESSION}:1 even-horizontal
done

# Split each column vertically for terminal (reverse order to keep pane numbering stable)
for i in $(seq ${COLS} -1 1); do
  tmux split-window -v -t ${SESSION}:1.${i} -p 30
done

# Full-width orchestrator pane at the bottom
tmux split-window -v -f -t ${SESSION}:1 -p 20 "claude-orchestrator"

# Focus first Claude pane
tmux select-pane -t ${SESSION}:1.1

tmux attach -t ${SESSION}
