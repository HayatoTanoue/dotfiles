#!/bin/bash
# tmux status color - set status bar color based on session name

# Color palette (distinct colors for status bar)
COLORS=(
  "7aa2f7"  # Blue (Tokyo Night)
  "bb9af7"  # Purple
  "9ece6a"  # Green
  "e0af68"  # Yellow/Orange
  "f7768e"  # Red/Pink
  "7dcfff"  # Cyan
  "c0caf5"  # Light blue
  "ff9e64"  # Orange
)

# Get session name
SESSION="${1:-$(tmux display-message -p '#S' 2>/dev/null)}"
[ -z "$SESSION" ] && exit 0

# Calculate hash and get color index
HASH=$(echo -n "$SESSION" | cksum | cut -d' ' -f1)
INDEX=$((HASH % ${#COLORS[@]}))
COLOR="${COLORS[$INDEX]}"

# Set tmux status styles
tmux set-option -g status-style "bg=#1a1b26,fg=#$COLOR"
tmux set-option -g status-left "#[fg=#1a1b26,bg=#$COLOR,bold] #S "
tmux set-option -g window-status-current-format "#[fg=#1a1b26,bg=#$COLOR,bold] #I:#W "

# Update session list (2nd status line) highlight color
tmux set-option -g status-format[1] "#[bg=#1a1b26,align=left]#{S:#{?session_attached,#[range=session|#{session_id} fg=#1a1b26 bg=#$COLOR bold],#[range=session|#{session_id} fg=#565f89 bg=#1a1b26]}#[push-default] #S #[pop-default]#[norange default]}"
